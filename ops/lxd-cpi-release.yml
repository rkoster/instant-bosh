---
# Add lxd-bosh-cpi release
- type: replace
  path: /releases/-
  value:
    name: lxd-bosh-cpi
    version: "7"
    url: https://github.com/a2geek/bosh-lxd-cpi-release/releases/download/v7/bosh-lxd-cpi-release.tgz
    sha1: ecd3973bdfbaada35f0a648479552e03dc62a110

# Add lxd_cpi job to bosh instance group with dummy config
# The actual config will be set at runtime via lxd-cpi.yml ops-file
- type: replace
  path: /instance_groups/name=bosh/jobs/-
  value:
    name: lxd_cpi
    release: lxd-bosh-cpi
    properties:
      lxd_cpi:
        # Only minimal set, will be overwritten using lxd-cpi.yml ops file
        # This file exists so that when running in docker mode
        # there are no missing variables
        server:
          url: https://localhost:8443
          insecure_skip_verify: true
          tls_client_cert: ""
          tls_client_key: ""
          project_name: default
          profile_name: default
          network_name: default
          storage_pool_name: default
        agent:
          blobstore: null
          mbus: nats://((internal_ip)):4222
