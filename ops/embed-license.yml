---
# Embed LICENSE file in the instant-bosh OCI image
# 
# This ops file adds a pre-start-script job that copies the LICENSE file
# to a standard location (/usr/share/doc/instant-bosh/LICENSE) in the container
# making it available for users inspecting the image or running containers.

# Add os-conf release if not already present
- path: /releases/name=os-conf?
  release: os-conf
  type: replace
  value:
    name: os-conf
    sha1: d20772d8ce6e781ceb13cac7df5950bfa4330ba1
    url: https://bosh.io/d/github.com/cloudfoundry/os-conf-release?v=23.0.0
    version: 23.0.0

# Add user-data job to embed LICENSE file
- path: /instance_groups/name=bosh/jobs/-
  type: replace
  value:
    name: user-data
    release: os-conf
    properties:
      users: []
      files:
      - path: /usr/share/doc/instant-bosh/LICENSE
        permissions: '0644'
        content: ((license_text))
